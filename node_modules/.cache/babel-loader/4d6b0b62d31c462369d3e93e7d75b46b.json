{"ast":null,"code":"import { eventScope } from '../utils/';\nvar KEY_CODE;\n\n(function (KEY_CODE) {\n  KEY_CODE[KEY_CODE[\"TAB\"] = 9] = \"TAB\";\n  KEY_CODE[KEY_CODE[\"SPACE\"] = 32] = \"SPACE\";\n  KEY_CODE[KEY_CODE[\"PAGE_UP\"] = 33] = \"PAGE_UP\";\n  KEY_CODE[KEY_CODE[\"PAGE_DOWN\"] = 34] = \"PAGE_DOWN\";\n  KEY_CODE[KEY_CODE[\"END\"] = 35] = \"END\";\n  KEY_CODE[KEY_CODE[\"HOME\"] = 36] = \"HOME\";\n  KEY_CODE[KEY_CODE[\"LEFT\"] = 37] = \"LEFT\";\n  KEY_CODE[KEY_CODE[\"UP\"] = 38] = \"UP\";\n  KEY_CODE[KEY_CODE[\"RIGHT\"] = 39] = \"RIGHT\";\n  KEY_CODE[KEY_CODE[\"DOWN\"] = 40] = \"DOWN\";\n})(KEY_CODE || (KEY_CODE = {}));\n\nexport function keyboardHandler(scrollbar) {\n  var addEvent = eventScope(scrollbar);\n  var container = scrollbar.containerEl;\n  addEvent(container, 'keydown', function (evt) {\n    var activeElement = document.activeElement;\n\n    if (activeElement !== container && !container.contains(activeElement)) {\n      return;\n    }\n\n    if (isEditable(activeElement)) {\n      return;\n    }\n\n    var delta = getKeyDelta(scrollbar, evt.keyCode || evt.which);\n\n    if (!delta) {\n      return;\n    }\n\n    var x = delta[0],\n        y = delta[1];\n    scrollbar.addTransformableMomentum(x, y, evt, function (willScroll) {\n      if (willScroll) {\n        evt.preventDefault();\n      } else {\n        scrollbar.containerEl.blur();\n\n        if (scrollbar.parent) {\n          scrollbar.parent.containerEl.focus();\n        }\n      }\n    });\n  });\n}\n\nfunction getKeyDelta(scrollbar, keyCode) {\n  var size = scrollbar.size,\n      limit = scrollbar.limit,\n      offset = scrollbar.offset;\n\n  switch (keyCode) {\n    case KEY_CODE.TAB:\n      return handleTabKey(scrollbar);\n\n    case KEY_CODE.SPACE:\n      return [0, 200];\n\n    case KEY_CODE.PAGE_UP:\n      return [0, -size.container.height + 40];\n\n    case KEY_CODE.PAGE_DOWN:\n      return [0, size.container.height - 40];\n\n    case KEY_CODE.END:\n      return [0, limit.y - offset.y];\n\n    case KEY_CODE.HOME:\n      return [0, -offset.y];\n\n    case KEY_CODE.LEFT:\n      return [-40, 0];\n\n    case KEY_CODE.UP:\n      return [0, -40];\n\n    case KEY_CODE.RIGHT:\n      return [40, 0];\n\n    case KEY_CODE.DOWN:\n      return [0, 40];\n\n    default:\n      return null;\n  }\n}\n\nfunction handleTabKey(scrollbar) {\n  // handle in next frame\n  requestAnimationFrame(function () {\n    scrollbar.scrollIntoView(document.activeElement, {\n      offsetTop: scrollbar.size.container.height / 2,\n      onlyScrollIfNeeded: true\n    });\n  });\n}\n\nfunction isEditable(elem) {\n  if (elem.tagName === 'INPUT' || elem.tagName === 'SELECT' || elem.tagName === 'TEXTAREA' || elem.isContentEditable) {\n    return !elem.disabled;\n  }\n\n  return false;\n}","map":{"version":3,"sources":["../src/events/keyboard.ts"],"names":[],"mappings":"AAEA,SACE,UADF,QAEO,WAFP;AAIA,IAAK,QAAL;;AAAA,CAAA,UAAK,QAAL,EAAa;AACX,EAAA,QAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,CAAA,GAAA,KAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,OAAA,CAAA,GAAA,EAAA,CAAA,GAAA,OAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,SAAA,CAAA,GAAA,EAAA,CAAA,GAAA,SAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,WAAA,CAAA,GAAA,EAAA,CAAA,GAAA,WAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,EAAA,CAAA,GAAA,KAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,MAAA,CAAA,GAAA,EAAA,CAAA,GAAA,MAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,MAAA,CAAA,GAAA,EAAA,CAAA,GAAA,MAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,IAAA,CAAA,GAAA,EAAA,CAAA,GAAA,IAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,OAAA,CAAA,GAAA,EAAA,CAAA,GAAA,OAAA;AACA,EAAA,QAAA,CAAA,QAAA,CAAA,MAAA,CAAA,GAAA,EAAA,CAAA,GAAA,MAAA;AACD,CAXD,EAAK,QAAQ,KAAR,QAAQ,GAAA,EAAA,CAAb;;AAaA,OAAM,SAAU,eAAV,CAA0B,SAA1B,EAAgD;AACpD,MAAM,QAAQ,GAAG,UAAU,CAAC,SAAD,CAA3B;AACA,MAAM,SAAS,GAAG,SAAS,CAAC,WAA5B;AAEA,EAAA,QAAQ,CAAC,SAAD,EAAY,SAAZ,EAAuB,UAAC,GAAD,EAAmB;AACxC,QAAA,aAAA,GAAA,QAAA,CAAA,aAAA;;AAER,QAAI,aAAa,KAAK,SAAlB,IAA+B,CAAC,SAAS,CAAC,QAAV,CAAmB,aAAnB,CAApC,EAAuE;AACrE;AACD;;AAED,QAAI,UAAU,CAAC,aAAD,CAAd,EAA+B;AAC7B;AACD;;AAED,QAAM,KAAK,GAAG,WAAW,CAAC,SAAD,EAAY,GAAG,CAAC,OAAJ,IAAe,GAAG,CAAC,KAA/B,CAAzB;;AAEA,QAAI,CAAC,KAAL,EAAY;AACV;AACD;;AAEM,QAAA,CAAA,GAAA,KAAA,CAAA,CAAA,CAAA;AAAA,QAAG,CAAA,GAAA,KAAA,CAAA,CAAA,CAAH;AAEP,IAAA,SAAS,CAAC,wBAAV,CAAmC,CAAnC,EAAsC,CAAtC,EAAyC,GAAzC,EAA8C,UAAC,UAAD,EAAW;AACvD,UAAI,UAAJ,EAAgB;AACd,QAAA,GAAG,CAAC,cAAJ;AACD,OAFD,MAEO;AACL,QAAA,SAAS,CAAC,WAAV,CAAsB,IAAtB;;AAEA,YAAI,SAAS,CAAC,MAAd,EAAsB;AACpB,UAAA,SAAS,CAAC,MAAV,CAAiB,WAAjB,CAA6B,KAA7B;AACD;AACF;AACF,KAVD;AAWD,GA9BO,CAAR;AA+BD;;AAED,SAAS,WAAT,CAAqB,SAArB,EAA6C,OAA7C,EAA4D;AAExD,MAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AAAA,MACA,KAAA,GAAA,SAAA,CAAA,KADA;AAAA,MAEA,MAAA,GAAA,SAAA,CAAA,MAFA;;AAKF,UAAQ,OAAR;AACE,SAAK,QAAQ,CAAC,GAAd;AACE,aAAO,YAAY,CAAC,SAAD,CAAnB;;AACF,SAAK,QAAQ,CAAC,KAAd;AACE,aAAO,CAAC,CAAD,EAAI,GAAJ,CAAP;;AACF,SAAK,QAAQ,CAAC,OAAd;AACE,aAAO,CAAC,CAAD,EAAI,CAAC,IAAI,CAAC,SAAL,CAAe,MAAhB,GAAyB,EAA7B,CAAP;;AACF,SAAK,QAAQ,CAAC,SAAd;AACE,aAAO,CAAC,CAAD,EAAI,IAAI,CAAC,SAAL,CAAe,MAAf,GAAwB,EAA5B,CAAP;;AACF,SAAK,QAAQ,CAAC,GAAd;AACE,aAAO,CAAC,CAAD,EAAI,KAAK,CAAC,CAAN,GAAU,MAAM,CAAC,CAArB,CAAP;;AACF,SAAK,QAAQ,CAAC,IAAd;AACE,aAAO,CAAC,CAAD,EAAI,CAAC,MAAM,CAAC,CAAZ,CAAP;;AACF,SAAK,QAAQ,CAAC,IAAd;AACE,aAAO,CAAC,CAAC,EAAF,EAAM,CAAN,CAAP;;AACF,SAAK,QAAQ,CAAC,EAAd;AACE,aAAO,CAAC,CAAD,EAAI,CAAC,EAAL,CAAP;;AACF,SAAK,QAAQ,CAAC,KAAd;AACE,aAAO,CAAC,EAAD,EAAK,CAAL,CAAP;;AACF,SAAK,QAAQ,CAAC,IAAd;AACE,aAAO,CAAC,CAAD,EAAI,EAAJ,CAAP;;AACF;AACE,aAAO,IAAP;AAtBJ;AAwBD;;AAED,SAAS,YAAT,CAAsB,SAAtB,EAA4C;AAC1C;AACA,EAAA,qBAAqB,CAAC,YAAA;AACpB,IAAA,SAAS,CAAC,cAAV,CAAyB,QAAQ,CAAC,aAAlC,EAAgE;AAC9D,MAAA,SAAS,EAAE,SAAS,CAAC,IAAV,CAAe,SAAf,CAAyB,MAAzB,GAAkC,CADiB;AAE9D,MAAA,kBAAkB,EAAE;AAF0C,KAAhE;AAID,GALoB,CAArB;AAMD;;AAED,SAAS,UAAT,CAAoB,IAApB,EAA6B;AAC3B,MAAI,IAAI,CAAC,OAAL,KAAiB,OAAjB,IACA,IAAI,CAAC,OAAL,KAAiB,QADjB,IAEA,IAAI,CAAC,OAAL,KAAiB,UAFjB,IAGA,IAAI,CAAC,iBAHT,EAG4B;AAC1B,WAAO,CAAC,IAAI,CAAC,QAAb;AACD;;AAED,SAAO,KAAP;AACD","sourceRoot":"","sourcesContent":["import { eventScope, } from '../utils/';\nvar KEY_CODE;\n(function (KEY_CODE) {\n    KEY_CODE[KEY_CODE[\"TAB\"] = 9] = \"TAB\";\n    KEY_CODE[KEY_CODE[\"SPACE\"] = 32] = \"SPACE\";\n    KEY_CODE[KEY_CODE[\"PAGE_UP\"] = 33] = \"PAGE_UP\";\n    KEY_CODE[KEY_CODE[\"PAGE_DOWN\"] = 34] = \"PAGE_DOWN\";\n    KEY_CODE[KEY_CODE[\"END\"] = 35] = \"END\";\n    KEY_CODE[KEY_CODE[\"HOME\"] = 36] = \"HOME\";\n    KEY_CODE[KEY_CODE[\"LEFT\"] = 37] = \"LEFT\";\n    KEY_CODE[KEY_CODE[\"UP\"] = 38] = \"UP\";\n    KEY_CODE[KEY_CODE[\"RIGHT\"] = 39] = \"RIGHT\";\n    KEY_CODE[KEY_CODE[\"DOWN\"] = 40] = \"DOWN\";\n})(KEY_CODE || (KEY_CODE = {}));\nexport function keyboardHandler(scrollbar) {\n    var addEvent = eventScope(scrollbar);\n    var container = scrollbar.containerEl;\n    addEvent(container, 'keydown', function (evt) {\n        var activeElement = document.activeElement;\n        if (activeElement !== container && !container.contains(activeElement)) {\n            return;\n        }\n        if (isEditable(activeElement)) {\n            return;\n        }\n        var delta = getKeyDelta(scrollbar, evt.keyCode || evt.which);\n        if (!delta) {\n            return;\n        }\n        var x = delta[0], y = delta[1];\n        scrollbar.addTransformableMomentum(x, y, evt, function (willScroll) {\n            if (willScroll) {\n                evt.preventDefault();\n            }\n            else {\n                scrollbar.containerEl.blur();\n                if (scrollbar.parent) {\n                    scrollbar.parent.containerEl.focus();\n                }\n            }\n        });\n    });\n}\nfunction getKeyDelta(scrollbar, keyCode) {\n    var size = scrollbar.size, limit = scrollbar.limit, offset = scrollbar.offset;\n    switch (keyCode) {\n        case KEY_CODE.TAB:\n            return handleTabKey(scrollbar);\n        case KEY_CODE.SPACE:\n            return [0, 200];\n        case KEY_CODE.PAGE_UP:\n            return [0, -size.container.height + 40];\n        case KEY_CODE.PAGE_DOWN:\n            return [0, size.container.height - 40];\n        case KEY_CODE.END:\n            return [0, limit.y - offset.y];\n        case KEY_CODE.HOME:\n            return [0, -offset.y];\n        case KEY_CODE.LEFT:\n            return [-40, 0];\n        case KEY_CODE.UP:\n            return [0, -40];\n        case KEY_CODE.RIGHT:\n            return [40, 0];\n        case KEY_CODE.DOWN:\n            return [0, 40];\n        default:\n            return null;\n    }\n}\nfunction handleTabKey(scrollbar) {\n    // handle in next frame\n    requestAnimationFrame(function () {\n        scrollbar.scrollIntoView(document.activeElement, {\n            offsetTop: scrollbar.size.container.height / 2,\n            onlyScrollIfNeeded: true,\n        });\n    });\n}\nfunction isEditable(elem) {\n    if (elem.tagName === 'INPUT' ||\n        elem.tagName === 'SELECT' ||\n        elem.tagName === 'TEXTAREA' ||\n        elem.isContentEditable) {\n        return !elem.disabled;\n    }\n    return false;\n}\n//# sourceMappingURL=keyboard.js.map"]},"metadata":{},"sourceType":"module"}